## mysql基本概念 [	](mysql_20200824100448996)

### 数据库的概念 [	](mysql_20200824100448999)

+ 数据库的作用：{{c1:: 高效的存储和管理数据，为编程语言提供数据支撑 }}
+ 数据库的目的:{{c1::就是能够存储（写）和提供（读）数据 }}

### 数据库分类 [	](mysql_20200824100449001)
数据库分类：根据数据库的架构和数据组织原理进行分类
1. 早期根据数据库的组织数据的存储模型分类
   + 层次数据库：{{c1:: 基于层次的数据结构（数据分层） }}
   + 网状数据库：{{c1:: 基于网状的数据结构（数据网络） }}
   + 关系数据库：{{c1:: 基于关系模型的数据结构（二维表） }}
2. 现在较多根据实际数据管理模型分类（存储介质）
   + 关系型数据库：{{c1:: 基于关系模型的数据结构（二维表）通常存储在磁盘 }}
   + 非关系型数据库：{{c1:: 没有具体模型的数据结构（键值对）通常存储在内存 }}

### 关系型数据库系统（DBS）模型有四层结构 [	](mysql_20200824100449003)

1. {{c1:: 数据库管理系统（DBMS）：管理系统运行（DataBase Management System） }}
2. {{c1:: 数据库（DB）：数据存储的管理者（小管理，受DBMS管理） }}
3. {{c1:: 数据表（Table）：数据关系管理者 }}
4. {{c1:: 数据字段（Field）：依赖于数据表，实际数据存储者 }}

### 非关系型数据库特点 [	](mysql_20200824100449005)

1. 非关系型数据库：{{c1:: NoSQL（Not only SQL），不仅仅是关系型数据库 }}
2. 数据存储模型：{{c1:: 键值对（key->value） }}
3. 存储的位置：{{c1:: 是内存（效率高） }}
4. 不能永久性存储：{{c1:: 需要定时存到关系型数据库中 }}

### 常见的非关系型数据库产品 [	](mysql_20200824100449008)

1. {{c1:: MongoDB }}
2. {{c1:: Redis }}
3. {{c1:: Memcached }}

### NoSQL数据库与关系型数据库比较 [	](mysql_20200824100449010)

+ 联系：{{c1:: NoSQL通常是与关系型数据库配合使用的，他们彼此是一种互补关系 }}
+ NoSQL运行在内存，解决{{c1::效率}}问题 
  + {{c1:: I/O问题 }}
  + {{c1:: 效率问题 }}
+ MySQL运行在磁盘，解决{{c1::稳定}}问题 
  + {{c1:: 安全问题（永久存储） }}
  + {{c1:: 稳定 }}

### SQL根据操作不同，分为几类 [	](mysql_20200824100449013)

1. DQL：{{c1:: Data Query Language，数据查询语言，用于查询和检索数据}}
2. DML：{{c1:: Data Manipulation Language，数据操作语言，用于数据的写操作（增删改） }}
3. DDL：{{c1:: Data Definition Language，数据定义语言，用于创建数据结构}}
4. DCL：{{c1:: Data Control Language，数据控制语言，用于用户权限管理}}
5. TPL：{{c1:: Transaction Process Language，事务处理语言，辅助DML进行事务操作（因此也归属于DML） }}

### 客户端需要连接认证 [	](mysql_20200824100449016)

+ 命令：{{c1::  `mysql -uroot -p123456` }}
+  -h：{{c1:: 主机地址（本机localhost可以省略） }}
+  -P：{{c1:: 端口号（默认3306可以省略） }}
+  -u：{{c1:: 用户名 }}
+  -p：{{c1:: 用户密码 }}

### 客户端退出服务端命令 [	](mysql_20200824100449018)

1. {{c1::`\q`}}
2. {{c1::`quit`}}
3. {{c1::`exit`}}

## MYSQL的基本操作 [	](mysql_20200824100449021)

### SQL指令语句结束符： [	](mysql_20200824100449024)

+ 默认是英文分号：{{c1:: `;`、`\g`、`\G` }}
+ \G：{{c1:: 主要用于查询数据，立体展示结果}}

### 基本操作 [	](mysql_20200824100449026)

+ 结构创建:{{c1::`create 结构类型 结构名 结构描述;`}}
+ 显示结构：{{c1::`show 结构类型（复数）;`}}
+ 显示结构创建详情：{{c1::`show create 结构类型 结构名;`}}
+ 新增数据:{{c1::`insert into 表名 values`}}
+ 查看数据:{{c1::`select from 表名`}}
+ 更新数据:{{c1::`update 表名 set `}}
+ 删除数据:{{c1::`delete from 表名`}}

## SQL库操作 [	](mysql_20200824100449029)

### 创建数据库 [	](mysql_20200824100449031)

1. 创建一个指定名字的数据库:{{c1:: `create database db_1;` }}
2. 创建一个指定字符集的数据库:{{c1:: `create database db_2 charset utf8MB4;` }}
3. 创建一个指定校对集的数据库:{{c1:: `create database db_3 charset utf8MB4 collate utf8mb4_general_ci;` }}
4. 数据库文件夹位置：TODO

### 显示数据库 [	](mysql_20200824100449034)
+ 显示所有数据库:{{c1::`show databases;`
+ 显示数据库创建指令:{{c1::`show create database db_1;`

### 使用数据库 [	](mysql_20200824100449037)

1. 使用数据库的指令是：{{c1:: `use 数据库名字;` }}
2. 使用数据库的目标
   + {{c1:: 让系统知道后续SQL指令都是针对当前选择的数据库 }}
   + {{c1:: 简化后续SQL指令的复杂度（如果不指定数据库，那么所有的SQL操作都必须强制指定数据库名字） }}

### 修改数据库 [	](mysql_20200824100449040)

+ 数据库名字不可修改（老版本可以）解决方法：
  +  {{c1:: 先新增 }}
  +  {{c1:: 后迁移 }}
  +  {{c1:: 最后删除 }}
+ 修改数据库字符集：{{c1:: `alter database db_2 charset gbk;` }}
+ 修改数据库校对集（校对集必须对应字符集）:{{c1:: `alter database db_3 charset gbk collate gbk_chinese_ci;` }}
+ 一般我们都不会使用数据库修改（一般要改也是删除后新增）

### 删除数据库 [	](mysql_20200824100449042)

+ 语法: {{c1:: `drop database db_1;` }}
+ 注意：{{c1:: 数据库的删除不可逆，千万要谨慎，删除之前得备份  }}
吗
## SQL表（字段）操作 [	](mysql_20200824100449045)

### 创建数据表 [	](mysql_20200824100449047)
+ 表创建语法
    {{c1::
    ```sql
        create table [数据库名.]表名(
            字段名 字段类型,
            ...
            字段名 字段类型
        )表选项;
        
    ```
    }}
+ 表可以指定表选项（都有默认值）
  +  存储引擎：{{c1:: engine [=] 具体存储引擎 }}
  +  字符集：{{c1:: [default] charset 具体字符集（继承数据库） }}
  +  校对集：{{c1:: collate（继承数据库） }}
  +  创建数据表——表选项
    {{c1::
    ```sql
        create table t_3(
            name varchar(50)
        )engine Innodb charset utf8MB4;
    ```
    }}
+ 如果想创建一个与已有表一样的数据表，MySQL提供了一种便捷的复制模式:
  + {{c1:: `create table 表名 like 数据库名字.表名` }}

### 数据引擎：`MyISAM` 和 `InnoDB` 的区别 [	](mysql_20200824100449049)
+  `InnoDB`
  +  {{c1:: 默认存储引擎 }}
  +  {{c1:: 支持事务处理和外键 }}
+  `MyIsam`
  +  {{c1:: 不支持事务和外键 }}
  +  {{c1:: 数据、表结构、索引独立管理 }}
  +  {{c1:: MySQL5.6以后不再维护 }}

### 显示数据表 [	](mysql_20200824100449052)

1. 显示所有数据表——当前数据库下:{{c1::`show tables;`}}
2. 显示所有数据表——指定数据库:{{c1::`show tables from db_3;`}}
3. 显示部分关联数据表——匹配:{{c1::`show tables like '%like';	# _表示匹配一个字符（固定位置），%表示匹配N个字符`}}
4. 显示数据表的创建指令:{{c1::`show create table t_1; # 看到的结果未必一定是真实创建的指令（系统会加工）`}}

### 查看数据表 [	](mysql_20200824100449054)
+ 目的：指查看数据表中的具体结构
+ 查看语法有三种（效果一样）:
  + `desc 表名；`
  + `describe 表名;`
  + `show columns from 表名;`

### 更改数据表 [	](mysql_20200824100449056)

1. 修改表名:{{c1:: `rename table t_1 to t1;` }}
    + 跨库修改：{{c1:: 需要使用`数据库名.表名` }}
2. 修改表选项:{{c1:: `alter table t1 charset utf8;` }}

### 更改字段

+ 新增字段:{{c1:: `alter table 表名 add [column] 字段名 字段类型 [字段属性] [字段位置]`}}
  + 字段位置分为两种：
      +  为t_3表增加一个id字段，放到最前面:{{c1:: `alter table t_3 add id int first;`}}
      +  在t_3表name字段后增加一个身份证字段card:{{c1:: `alter table t_3 add card varchar(18) after name;`}}
+ 更改字段名:{{c1:: `alter table 表名 change 原字段名 新字段名 字段类型 [字段属性] [字段位置]`}}
  + 修改身份证的类型为char(18)并且位置放到id后面:{{c1:: `alter table t_3 modify sfz char(18) after id;`}}
+ 删除字段:{{c1:: `alter table 表名 drop 字段名;`}}
  + 注意：{{c1:: 同时会删除字段对应的数据，而且不可逆}}

### SQL数据操作

+ 新增数据：数据插入分两种方式
  +  全字段插入：{{c1:: `insert into 表名 values(字段列表顺序对应的所有值);` }}
  +  部分字段插入：{{c1:: `insert into 表名 (字段列表) values(字段列表对应的值顺序列表);` }}
+ 更新数据：
  + 语法： {{c1:: `update 表名 set 字段 = 新值[,字段 = 新值] [where条件筛选];` }}
+ 删除数据：
  + 语法： {{c1:: `delete from 表名 [where条件];` }}

MySQL内部对象存在字符集继承：`字段 -> 表 -> 数据库 -> DBMS`
客户端与服务器进行交互时，需要明确告知服务器客户端自己的字符集（数据格式）:`set names 客户端字符集;`

### `set names 字符集`是一种快捷方式，本质有三个变量被修改:

1. {{c1::`character_set_client`： 服务端接收客户端数据 }}
2. {{c1::`character_set_connection`： 服务端内部连接使用 }}
3. {{c1::`character_set_results`： 服务端提供数据给客户端 }}

### 校对集概念

**校对集**：{{c1:: collate/collation，即数据比较时对应的规则 }}
+  校对集依赖字符集,每个字符集有多种校对规则
+  校对集的校对方式分为三种
  +  大小写不敏感：{{c1:: `_ci，case insensitive（不区分大小写）` }}
  +  大小写敏感：{{c1:: `_cs，case sensitive（区分大小写）` }}
  +  二进制比较：{{c1:: `_bin，binary（区分大小写）` }}
+  校对集是在进行数据比较的时候触发
+ 校对规则可以在MySQL四中内部对象中设置:{{c1:: `DBMS->DB->Table->Field` }}
+ 校对集对应的数据一旦产生，那么就不可以修改数据表的校对规则

### 校对集设置语法

1. 查看MySQL支持的所有校对集：{{c1::`show collation;`}}
2. 在数据**库**层设计校对集（常见）：{{c1::`create database db_4 charset utf8mb4 collate utf8mb4_bin;`}}
3. 在数据**表**层设计校对集:
  ```sql
    #{{c1::
    create table t_4(
      id int,
      name varchar(10)
    )charset utf8mb4 collate utf8mb4_bin;
    #}}
  ```
4. 在**字段**层设计校对集（一般不常用）:
  ```sql
    #{{c1::
    create table t_5(
      id int,
      name varchar(10) collate utf8mb4_bin
    )charset utf8mb4;
    #}}
  ```
## Mysql数据库字段详解

### mysql的数据类型
+ 作用：{{c1:: 强制规范录入数据的格式 }}
+ MySQL中有四种数据类型规范
  +  {{c1:: 整数类型 }}
  +  {{c1:: 小数类型 }}
  +  {{c1:: 字符串类型 }}
  +  {{c1:: 时间日类类型 }}

  ### 整数类型
  + MySQL中为了**数据空间**的有效使用，设定了五种整数类型
  +  {{c1:: 迷你整型：`tinyint`，使用**1个字节**存储整数，最多存储256个整数（-128~127） }}
  +  {{c1:: 短整型：`smallint`，使用**2个字节**存储整数 }}
  +  {{c1:: 中整型：`mediumint`，使用**3个字节**存储整数 }}
  +  {{c1:: 标准整型：`int`，使用**4个字节**存储整数 }}
  +  {{c1:: 大整型：`bigint`，使用**8个字节**存储 }}
+ 有符号与无符号：{{c1:: 默认是有符号的，无符号需要使用unsigned修饰整型}}
  例：{{c1:: `sales mediumint unsigned,` }}